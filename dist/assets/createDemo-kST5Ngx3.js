import"./modulepreload-polyfill-B5Qt9EMX.js";import{d as a}from"./auth-CEjR0vsn.js";import"https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";let l=!1,u=!1;async function g(e,t,n,s,d,y,i,o){try{y.classList.remove("hidden"),o.disabled=!0,o.classList.add("opacity-50"),i.textContent="Creating...";const{data:r,error:c}=await a.auth.signUp({email:e,password:t,options:{data:{full_name:n,role:s}}});if(c){if(c.message.includes("already registered"))return d.className="mt-2 p-3 rounded-lg bg-yellow-50 text-yellow-800 text-sm",d.textContent=`✓ Account already exists! You can login with: ${e}`,d.classList.remove("hidden"),!0;throw c}if(r.user){const{error:m}=await a.from("user_profiles").insert({id:r.user.id,email:e,full_name:n,role:s,has_completed_survey:!1});if(m&&!m.message.includes("duplicate"))throw m;return s==="student"&&await a.from("student_surveys").insert({user_id:r.user.id,exam_type:"neet",target_date:"2025-05-15",study_hours_per_day:6,weak_subjects:["physics","chemistry"],strong_subjects:["biology"],learning_style:"visual"}).then(()=>a.from("user_profiles").update({has_completed_survey:!0}).eq("id",r.user.id)),d.className="mt-2 p-3 rounded-lg bg-green-50 text-green-800 text-sm",d.textContent=`✓ ${s.charAt(0).toUpperCase()+s.slice(1)} account created successfully!`,d.classList.remove("hidden"),i.textContent="✓ Created",o.classList.remove("opacity-50"),o.classList.add("bg-green-600"),!0}throw new Error("User creation failed")}catch(r){return console.error("Error:",r),d.className="mt-2 p-3 rounded-lg bg-red-50 text-red-800 text-sm",d.textContent=`✗ Error: ${r.message}`,d.classList.remove("hidden"),document.getElementById("errorBox").classList.remove("hidden"),document.getElementById("errorMessage").textContent=r.message,o.disabled=!1,o.classList.remove("opacity-50"),i.textContent="Try Again",!1}finally{y.classList.add("hidden")}}document.getElementById("createStudentBtn").addEventListener("click",async()=>{const e=document.getElementById("createStudentBtn"),t=document.getElementById("studentSpinner"),n=document.getElementById("studentBtnText"),s=document.getElementById("studentStatus");l=await g("student@demo.com","demo123456","Demo Student","student",s,t,n,e),l&&u&&document.getElementById("credentials").classList.remove("hidden")});document.getElementById("createAdminBtn").addEventListener("click",async()=>{const e=document.getElementById("createAdminBtn"),t=document.getElementById("adminSpinner"),n=document.getElementById("adminBtnText"),s=document.getElementById("adminStatus");u=await g("admin@demo.com","admin123456","Demo Admin","admin",s,t,n,e),l&&u&&document.getElementById("credentials").classList.remove("hidden")});async function p(){const{data:e}=await a.from("user_profiles").select("email, role").in("email",["student@demo.com","admin@demo.com"]);if(e&&e.length>0){const t=document.createElement("div");t.className="mb-4 p-4 bg-yellow-50 border-l-4 border-yellow-500 rounded",t.innerHTML=`
                    <p class="text-yellow-900 font-semibold mb-2">ℹ️ Found Existing Accounts</p>
                    <p class="text-yellow-800 text-sm mb-2">These accounts already exist:</p>
                    <ul class="text-yellow-800 text-sm list-disc list-inside">
                        ${e.map(n=>`<li>${n.email} (${n.role})</li>`).join("")}
                    </ul>
                    <p class="text-yellow-800 text-sm mt-2">You can login directly or create new ones if passwords don't work.</p>
                `,document.getElementById("instructions").after(t)}}p();
